

### 结构体 转化

本地命令行打标签：

[github.com/fatih/gomodifytags]()

https://mholt.github.io/json-to-go/  （在线需要翻墙）

https://github.com/topics/translates-json （github 有权限限制,可以放到本地）



#### 问题：

1.  下面的输出是怎么样的？

```go
package main

import (
	"encoding/json"
	"fmt"
)

type AutoGenerated struct {
	Age   int    `json:"age"`
	Name  string `json:"name"`
	Child []int  `json:"child"`
}

func main() {
	jsonStr1 := `{"age": 14,"name": "potter", "child":[1,2,3]}`
	a := AutoGenerated{}
	json.Unmarshal([]byte(jsonStr1), &a)
	aa := a.Child
	fmt.Println(aa)
	jsonStr2 := `{"age": 12,"name": "potter", "child":[3,4,5,7,8,9]}`
	json.Unmarshal([]byte(jsonStr2), &a)
	fmt.Println(aa)
}
```



2. 下面代码会recover 吗？

```go

func TestGo(t *testing.T) {

	Go1()
	for {
		select {
		case <-time.NewTicker(time.Second).C:
			fmt.Println(1)

		}
	}
}

func Go1() {
    defer func() {
		if r := recover(); r != nil {
			fmt.Println(string(debug.Stack())) //输出堆栈信息
		}
	}()
	go Go2()
}
func Go2() {
	panic("")
}
```



**init()** function is just like the main function, does  not take any argument nor return anything. This function is present in  every package and this function is called when the package is  initialized. This function is declared implicitly, so you cannot  reference it from anywhere and you are allowed to create multiple **init()** function in the same program and they execute in the order they are  created. You are allowed to create init() function anywhere in the  program and they are called in lexical file name order (Alphabetical  Order). And allowed to put statements if the init() function, but always remember to init() function is executed before the main() function  call, so it does not depend to **main()** function. The main purpose of the **init()** function is to initialize the global variables that cannot be initialized in the global context. 

**Example:**

```go
// Go program to illustrate the 
// concept of init() function 

// Declaration of the main package 
package main 

// Importing package 
import "fmt"

// Multiple init() function 
func init() { 
	fmt.Println("Welcome to init() function") 
} 

func init() { 
	fmt.Println("Hello! init() function") 
} 

// Main function 
func main() { 
	fmt.Println("Welcome to main() function") 
} 

```

**Output:**

```go
Welcome to init() function
Hello! init() function
Welcome to main() function
```



### sync

https://cloud.tencent.com/developer/article/1621548



#### sync.Cond

```go
package main

import (
    "fmt"
    "sync"
    "time"
)

var locker = new(sync.Mutex)
var cond = sync.NewCond(locker)

func main() {
    for i := 0; i < 10; i++ {
        go func(x int) {
            cond.L.Lock()         //获取锁
            defer cond.L.Unlock() //释放锁
            cond.Wait()           //等待通知，阻塞当前goroutine
            fmt.Println(x)
        }(i)
    }   
    time.Sleep(time.Second * 1)	// 睡眠1秒，使所有goroutine进入 Wait 阻塞状态
    fmt.Println("Signal...")
    cond.Signal()               // 1秒后下发一个通知给已经获取锁的goroutine
    time.Sleep(time.Second * 1)
    fmt.Println("Signal...")
    cond.Signal()               // 1秒后下发下一个通知给已经获取锁的goroutine
    time.Sleep(time.Second * 1)
    cond.Broadcast()            // 1秒后下发广播给所有等待的goroutine
    fmt.Println("Broadcast...")
    time.Sleep(time.Second * 1)	// 睡眠1秒，等待所有goroutine执行完毕
}
```





